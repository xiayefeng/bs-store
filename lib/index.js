import{version as e}from"../../../../package.json";var t;function o(){for(var e=0,t=0,o=Reflect.ownKeys(sessionStorage);t<o.length;t++){var s=o[t];e+=sessionStorage.getItem(s).length}return console.log("sessionStorage used "+(e/1024).toFixed(2)+"kb"),e}function s(){for(var e=0,t=0,o=Reflect.ownKeys(localStorage);t<o.length;t++){var s=o[t];e+=localStorage.getItem(s).length}return console.log("localStorage used "+(e/1024).toFixed(2)+"kb"),e}!function(e){e[e.session=1]="session",e[e.local=2]="local",e[e.all=3]="all"}(t||(t={}));var r=new(function(){function o(){this.compress=!1,this.version=e,this.compressPlugin={}}return o.prototype.use=function(e){e.isCompress&&(this.compress=!0,this.compressPlugin=e.plugin)},o.prototype.getSession=function(e){if("string"!=typeof e)throw new Error("params must be string");var t=this.getItem(e);return null===t?(console.log("no exist such "+e+" sessionStorage"),null):this.getValue(t)},o.prototype.getValue=function(e){try{var t=JSON.parse(e);return t=this.checkStr(t),t=this.checkNaN(t),t=this.checkBigInt(t)}catch(t){return e}},o.prototype.getLocal=function(e){if("string"!=typeof e)throw new Error("params must be string");var o=this.getItem(e,t.local);return null===o?(console.log("no exist such "+e+" çš„localStorage"),null):this.getValue(o)},o.prototype.setSession=function(e,t){this.setItem(e,t)},o.prototype.setLocal=function(e,o){this.setItem(e,o,t.local)},o.prototype.removeSession=function(e){this.removeItem(e)},o.prototype.removeLocal=function(e){this.removeItem(e,t.local)},o.prototype.removeAllSession=function(){this.removeAll()},o.prototype.removeAllLocal=function(){this.removeAll(t.local)},o.prototype.removeAllStorage=function(){this.removeAll(t.all)},o.prototype.getItem=function(e,o){void 0===o&&(o=t.session);var s=null;return o===t.session?s=sessionStorage.getItem(e):o===t.local&&(s=localStorage.getItem(e)),null===s||this.compress&&(s=this.compressPlugin.decompress?this.compressPlugin.decompress(s):null),s},o.prototype.setItem=function(e,o,s){if(void 0===s&&(s=t.session),"string"!=typeof e)throw new Error("Items key params must be string");if(void 0===o)throw new Error("set value is not defind");if("symbol"==typeof o)throw new Error("value is not support symbol");"object"==typeof o?o=JSON.stringify(o):"string"==typeof o?o=JSON.stringify({str:o,isString2Object:!0}):Number.isNaN(o)?o=JSON.stringify({num:null,isNaN2Object:!0}):"bigint"==typeof o&&(o=JSON.stringify({num:String(o),isBigInt2Object:!0})),this.compress&&(o=this.compressPlugin.compress?this.compressPlugin.compress(String(o)):null),s===t.session?sessionStorage.setItem(e,o):localStorage.setItem(e,o)},o.prototype.removeItem=function(e,o){if(void 0===o&&(o=t.session),"string"!=typeof e)throw new Error("Items key params must be string");o===t.session&&null!=sessionStorage.getItem(e)?sessionStorage.removeItem(e):o===t.local&&null!=localStorage.getItem(e)&&localStorage.removeItem(e)},o.prototype.removeAll=function(e){if(void 0===e&&(e=t.session),e===t.session)sessionStorage.clear();else if(e===t.local)localStorage.clear();else{if(e!==t.all)throw new Error("param error, param must be one of 1,2,3");sessionStorage.clear(),localStorage.clear()}},o.prototype.checkStr=function(e){var t=e;return"Object"===this.checkedType(t)&&Reflect.has(t,"isString2Object")&&t.isString2Object&&(t=t.str),t},o.prototype.checkNaN=function(e){var t=e;return"Object"===this.checkedType(t)&&Reflect.has(t,"isNaN2Object")&&(t=NaN),t},o.prototype.checkBigInt=function(e){var t=e;return"Object"===this.checkedType(t)&&Reflect.has(t,"isBigInt2Object")&&(t=BigInt(t.num)),t},o.prototype.checkedType=function(e){return Object.prototype.toString.call(e).slice(8,-1)},o}());export default r;export{s as getLocalSize,o as getSessionSize};
